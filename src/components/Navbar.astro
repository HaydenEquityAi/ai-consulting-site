---
// Universal Navigation Bar Component
// Used across ALL pages of the site
---

<nav class="fixed top-0 left-0 right-0 z-50 bg-white border-b border-gray-200">
  <div class="max-w-7xl mx-auto px-4 sm:px-6 py-3 sm:py-4">
    <div class="flex items-center justify-between">
      <!-- LEFT: Logo -->
      <a href="/" class="text-2xl sm:text-3xl font-medium tracking-tight text-black">intelio</a>
      
      <!-- CENTER: Navigation Items -->
      <div class="hidden md:flex items-center gap-8">
        <!-- What We Build Dropdown -->
        <div class="relative group">
          <button class="flex items-center gap-1 text-base text-gray-700 hover:text-black transition-colors">
            What We Build
            <svg class="w-4 h-4 transition-transform group-hover:rotate-180" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
            </svg>
          </button>
          <div class="absolute left-0 top-full w-[600px] bg-white rounded-2xl shadow-xl border border-gray-200 relative z-[100] overflow-hidden" style="transform: translateZ(0) scale(1); -webkit-transform: translateZ(0) scale(1); filter: none;">
            <div class="grid grid-cols-2 gap-6 p-5">
              <!-- LEFT COLUMN: Outcomes -->
              <div>
                <p class="text-xs uppercase tracking-[0.08em] text-gray-500 mb-3">Outcomes</p>
                <div class="space-y-3">
                  <a href="/what-we-build/business-intelligence" class="group/item block hover:bg-gray-50 rounded-lg p-2 -m-2 transition-colors">
                    <h3 class="text-sm font-semibold text-gray-900 mb-1 group-hover/item:text-blue-600 transition-colors">Business Intelligence Systems</h3>
                    <p class="text-xs text-gray-600">Revenue, operations, and decision-making systems that run the business.</p>
                  </a>
                  <a href="/what-we-build/revenue-growth" class="group/item block hover:bg-gray-50 rounded-lg p-2 -m-2 transition-colors">
                    <h3 class="text-sm font-semibold text-gray-900 mb-1 group-hover/item:text-blue-600 transition-colors">Revenue & Growth Systems</h3>
                    <p class="text-xs text-gray-600">Lead capture, sales workflows, follow-up, and pipeline visibility.</p>
                  </a>
                  <a href="/what-we-build/operational" class="group/item block hover:bg-gray-50 rounded-lg p-2 -m-2 transition-colors">
                    <h3 class="text-sm font-semibold text-gray-900 mb-1 group-hover/item:text-blue-600 transition-colors">Operational Systems</h3>
                    <p class="text-xs text-gray-600">Execution, delivery, internal workflows, and accountability.</p>
                  </a>
                  <a href="/what-we-build/financial-decision" class="group/item block hover:bg-gray-50 rounded-lg p-2 -m-2 transition-colors">
                    <h3 class="text-sm font-semibold text-gray-900 mb-1 group-hover/item:text-blue-600 transition-colors">Financial & Decision Systems</h3>
                    <p class="text-xs text-gray-600">Reporting, forecasting, performance visibility, and control.</p>
                  </a>
                  <a href="/what-we-build/custom-platforms" class="group/item block hover:bg-gray-50 rounded-lg p-2 -m-2 transition-colors">
                    <h3 class="text-sm font-semibold text-gray-900 mb-1 group-hover/item:text-blue-600 transition-colors">Custom Internal Platforms</h3>
                    <p class="text-xs text-gray-600">Purpose-built systems when off-the-shelf tools don't fit.</p>
                  </a>
                </div>
              </div>
              
              <!-- RIGHT COLUMN: How It's Enabled -->
              <div>
                <p class="text-xs uppercase tracking-[0.08em] text-gray-500 mb-3">How It's Enabled</p>
                <div class="space-y-3">
                  <a href="/what-we-build/ai-automation" class="group/item block hover:bg-gray-50 rounded-lg p-2 -m-2 transition-colors">
                    <h3 class="text-sm font-semibold text-gray-900 mb-1 group-hover/item:text-blue-600 transition-colors">AI & Automation Enablement</h3>
                    <p class="text-xs text-gray-600">Applied where it removes friction or scales decisions.</p>
                  </a>
                  <a href="/what-we-build/integration" class="group/item block hover:bg-gray-50 rounded-lg p-2 -m-2 transition-colors">
                    <h3 class="text-sm font-semibold text-gray-900 mb-1 group-hover/item:text-blue-600 transition-colors">System Integration & Tooling</h3>
                    <p class="text-xs text-gray-600">Connecting CRMs, accounting, operations, and data.</p>
                  </a>
                  <a href="/build-maintain" class="group/item block hover:bg-gray-50 rounded-lg p-2 -m-2 transition-colors">
                    <h3 class="text-sm font-semibold text-gray-900 mb-1 group-hover/item:text-blue-600 transition-colors">Build + Maintain</h3>
                    <p class="text-xs text-gray-600">We build and support the systems your team operates.</p>
                  </a>
                  <a href="/build-operate" class="group/item block hover:bg-gray-50 rounded-lg p-2 -m-2 transition-colors">
                    <h3 class="text-sm font-semibold text-gray-900 mb-1 group-hover/item:text-blue-600 transition-colors">Build + Operate</h3>
                    <p class="text-xs text-gray-600">We run the systems with you or for you.</p>
                  </a>
                </div>
              </div>
            </div>
            <!-- Dropdown Footer -->
            <div class="border-t border-gray-100 px-5 py-3">
              <a href="/how-we-work" class="flex items-center gap-2 text-sm text-blue-600 font-medium hover:text-blue-700 transition-colors">
                <span>Explore how we work</span>
                <svg class="w-4 h-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <path d="M5 12h14" />
                  <path d="M13 6l6 6-6 6" />
                </svg>
              </a>
            </div>
          </div>
        </div>
        
        <!-- How We Work (single link) -->
        <a href="/how-we-work" class="text-base text-gray-700 hover:text-black transition-colors">How We Work</a>
        
        <!-- Case Studies (single link) -->
        <a href="/case-studies" class="text-base text-gray-700 hover:text-black transition-colors">Case Studies</a>
        
        <!-- Resources Dropdown -->
        <div class="relative group">
          <button class="flex items-center gap-1 text-base text-gray-700 hover:text-black transition-colors">
            Resources
            <svg class="w-4 h-4 transition-transform group-hover:rotate-180" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
            </svg>
          </button>
          <div class="absolute left-0 top-full w-64 bg-white rounded-2xl shadow-xl border border-gray-200 relative z-[100] overflow-hidden" style="transform: translateZ(0) scale(1); -webkit-transform: translateZ(0) scale(1); filter: none;">
            <div class="p-4 space-y-3">
              <a href="/resources/insights" class="block hover:bg-gray-50 rounded-lg p-3 -m-3 transition-colors">
                <h3 class="text-base font-semibold text-gray-900 mb-1">Insights</h3>
                <p class="text-sm text-gray-600">Articles and perspectives on business systems.</p>
              </a>
              <a href="/resources/tools" class="block hover:bg-gray-50 rounded-lg p-3 -m-3 transition-colors">
                <h3 class="text-base font-semibold text-gray-900 mb-1">Tools</h3>
                <p class="text-sm text-gray-600">A curated list of AI tools we use and recommend</p>
              </a>
              <a href="/resources/glossary" class="block hover:bg-gray-50 rounded-lg p-3 -m-3 transition-colors">
                <h3 class="text-base font-semibold text-gray-900 mb-1">Glossary</h3>
                <p class="text-sm text-gray-600">Definitions and terminology.</p>
              </a>
            </div>
          </div>
        </div>
      </div>
      
      <!-- RIGHT: CTA Button -->
      <div class="hidden md:flex items-center">
        <a href="/contact" class="px-5 py-2.5 bg-black text-white text-base font-medium rounded-full hover:bg-gray-800 transition-colors">Work With Us</a>
      </div>
      
      <!-- Mobile Menu Button -->
      <button type="button" id="mobile-menu-button" class="md:hidden p-3 min-h-[48px] min-w-[48px] flex items-center justify-center" aria-label="Toggle menu" aria-expanded="false">
        <svg id="mobile-menu-icon" class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path id="menu-icon-open" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
          <path id="menu-icon-close" class="hidden" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
        </svg>
      </button>
    </div>
    
    <!-- Mobile Menu -->
    <div id="mobile-menu" class="hidden md:hidden mt-4 pb-4 border-t border-gray-100 bg-white z-40 max-h-[calc(100vh-80px)] overflow-y-auto">
      <nav class="flex flex-col gap-2 sm:gap-4 pt-4 px-4 sm:px-6">
        <!-- What We Build (Mobile Accordion) -->
        <div class="py-2">
          <button type="button" class="what-we-build-toggle text-sm font-medium text-gray-700 hover:text-black w-full text-left flex items-center justify-between min-h-[44px]">
            What We Build
            <span class="what-we-build-icon text-xs">+</span>
          </button>
          <div class="what-we-build-submenu hidden pl-4 space-y-2 border-l border-gray-200 mt-2">
            <p class="text-xs uppercase text-gray-500 mb-2">Outcomes</p>
            <a href="/what-we-build/business-intelligence" class="block text-sm text-gray-600 hover:text-black transition-colors py-2 min-h-[44px] flex items-center">Business Intelligence Systems</a>
            <a href="/what-we-build/revenue-growth" class="block text-sm text-gray-600 hover:text-black transition-colors py-2 min-h-[44px] flex items-center">Revenue & Growth Systems</a>
            <a href="/what-we-build/operational" class="block text-sm text-gray-600 hover:text-black transition-colors py-2 min-h-[44px] flex items-center">Operational Systems</a>
            <a href="/what-we-build/financial-decision" class="block text-sm text-gray-600 hover:text-black transition-colors py-2 min-h-[44px] flex items-center">Financial & Decision Systems</a>
            <a href="/what-we-build/custom-platforms" class="block text-sm text-gray-600 hover:text-black transition-colors py-2 min-h-[44px] flex items-center">Custom Internal Platforms</a>
            <p class="text-xs uppercase text-gray-500 mb-2 mt-4">How It's Enabled</p>
            <a href="/what-we-build/ai-automation" class="block text-sm text-gray-600 hover:text-black transition-colors py-2 min-h-[44px] flex items-center">AI & Automation Enablement</a>
            <a href="/what-we-build/integration" class="block text-sm text-gray-600 hover:text-black transition-colors py-2 min-h-[44px] flex items-center">System Integration & Tooling</a>
            <a href="/build-maintain" class="block text-sm text-gray-600 hover:text-black transition-colors py-2 min-h-[44px] flex items-center">Build + Maintain</a>
            <a href="/build-operate" class="block text-sm text-gray-600 hover:text-black transition-colors py-2 min-h-[44px] flex items-center">Build + Operate</a>
            <a href="/how-we-work" class="block text-sm text-blue-600 hover:text-blue-700 transition-colors py-2 min-h-[44px] flex items-center">Explore how we work →</a>
          </div>
        </div>
        
        <!-- How We Work (Mobile) -->
        <a href="/how-we-work" class="block py-2 text-sm text-gray-700 hover:text-black transition-colors min-h-[44px] flex items-center">How We Work</a>
        
        <!-- Case Studies (Mobile) -->
        <a href="/case-studies" class="block py-2 text-sm text-gray-700 hover:text-black transition-colors min-h-[44px] flex items-center">Case Studies</a>
        
        <!-- Resources (Mobile Accordion) -->
        <div class="py-2">
          <button type="button" class="resources-toggle text-sm font-medium text-gray-700 hover:text-black w-full text-left flex items-center justify-between min-h-[44px]">
            Resources
            <span class="resources-icon text-xs">+</span>
          </button>
          <div class="resources-submenu hidden pl-4 space-y-2 border-l border-gray-200 mt-2">
            <a href="/resources/insights" class="block text-sm text-gray-600 hover:text-black transition-colors py-2 min-h-[44px] flex items-center">Insights</a>
            <a href="/resources/tools" class="block text-sm text-gray-600 hover:text-black transition-colors py-2 min-h-[44px] flex items-center">Tools</a>
            <a href="/resources/glossary" class="block text-sm text-gray-600 hover:text-black transition-colors py-2 min-h-[44px] flex items-center">Glossary</a>
          </div>
        </div>
        
        <!-- Work With Us (Mobile) -->
        <a href="/contact" class="block py-3 mt-4 bg-black text-white text-sm text-center rounded-full hover:bg-gray-800 transition-colors min-h-[44px] flex items-center justify-center">Work With Us</a>
      </nav>
    </div>
  </div>
</nav>

<style>
  /* Dropdown visibility using CSS - matches existing pattern */
  nav .group > div[class*="absolute"] {
    z-index: 9999 !important;
    position: absolute;
    display: none !important;
    transform: translateZ(0) scale(1);
    -webkit-transform: translateZ(0) scale(1);
    will-change: transform;
    backface-visibility: hidden;
    -webkit-backface-visibility: hidden;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
    text-rendering: optimizeLegibility;
    image-rendering: crisp-edges;
    filter: none !important;
    opacity: 1 !important;
    transition: none !important;
    visibility: hidden !important;
    pointer-events: none !important;
    margin-top: 0 !important;
    top: calc(100% - 0.5rem) !important;
  }

  /* Invisible bridge for hover continuity */
  nav .group > div[class*="absolute"]::before {
    content: '';
    position: absolute;
    top: -1rem;
    left: -50px;
    right: -50px;
    width: calc(100% + 100px);
    height: 1rem;
    background: transparent;
    z-index: 10001;
    pointer-events: auto;
  }

  /* Show dropdown on hover */
  nav .group:hover > div[class*="absolute"] {
    display: block !important;
    visibility: visible !important;
    pointer-events: auto !important;
    opacity: 1 !important;
    transition: none !important;
    filter: none !important;
  }

  /* Keep dropdown open when hovering over it */
  nav .group > div[class*="absolute"]:hover {
    display: block !important;
    visibility: visible !important;
    pointer-events: auto !important;
    opacity: 1 !important;
  }
  
  /* Mobile menu improvements */
  @media (max-width: 767px) {
    #mobile-menu {
      position: relative;
      z-index: 40;
      max-height: calc(100vh - 80px);
      overflow-y: auto;
      -webkit-overflow-scrolling: touch;
    }
    
    #mobile-menu-button {
      touch-action: manipulation;
      -webkit-tap-highlight-color: transparent;
    }
    
    /* Ensure mobile menu items are easily tappable */
    #mobile-menu a,
    #mobile-menu button {
      touch-action: manipulation;
      -webkit-tap-highlight-color: rgba(0, 0, 0, 0.1);
    }
    
    /* Prevent body scroll when menu is open */
    body.menu-open {
      overflow: hidden;
    }
  }
</style>

<script>
  (function() {
    function initMobileMenu() {
      var btn = document.getElementById('mobile-menu-button');
      var menu = document.getElementById('mobile-menu');
      var iconOpen = document.getElementById('menu-icon-open');
      var iconClose = document.getElementById('menu-icon-close');
      
      if (!btn || !menu) {
        return;
      }
      
      btn.addEventListener('click', function(e) {
        e.preventDefault();
        e.stopPropagation();
        
        var isHidden = menu.classList.contains('hidden');
        menu.classList.toggle('hidden');
        
        // Toggle body scroll lock on mobile
        if (window.innerWidth < 768) {
          if (isHidden) {
            document.body.classList.add('menu-open');
          } else {
            document.body.classList.remove('menu-open');
          }
        }
        
        // Update icon based on menu state
        if (iconOpen && iconClose) {
          if (isHidden) {
            // Opening menu - show close icon, hide open icon
            iconOpen.classList.add('hidden');
            iconClose.classList.remove('hidden');
            btn.setAttribute('aria-expanded', 'true');
          } else {
            // Closing menu - show open icon, hide close icon
            iconOpen.classList.remove('hidden');
            iconClose.classList.add('hidden');
            btn.setAttribute('aria-expanded', 'false');
          }
        }
      });
      
      // Close when clicking outside
      document.addEventListener('click', function(e) {
        if (!menu.contains(e.target) && !btn.contains(e.target) && !menu.classList.contains('hidden')) {
          menu.classList.add('hidden');
          document.body.classList.remove('menu-open');
          if (iconOpen && iconClose) {
            iconOpen.classList.remove('hidden');
            iconClose.classList.add('hidden');
            btn.setAttribute('aria-expanded', 'false');
          }
        }
      });
      
      // Prevent menu from closing when clicking inside it
      menu.addEventListener('click', function(e) {
        e.stopPropagation();
      });
      
      // Close menu when a link is clicked (but not for accordion toggles)
      var menuLinks = menu.querySelectorAll('a:not(.what-we-build-toggle):not(.resources-toggle)');
      menuLinks.forEach(function(link) {
        link.addEventListener('click', function() {
          menu.classList.add('hidden');
          document.body.classList.remove('menu-open');
          if (iconOpen && iconClose) {
            iconOpen.classList.remove('hidden');
            iconClose.classList.add('hidden');
            btn.setAttribute('aria-expanded', 'false');
          }
        });
      });
    }
    
    // Mobile accordion toggles
    function initMobileAccordions() {
      // What We Build toggle
      var whatWeBuildToggle = document.querySelector('.what-we-build-toggle');
      var whatWeBuildSubmenu = document.querySelector('.what-we-build-submenu');
      var whatWeBuildIcon = document.querySelector('.what-we-build-icon');
      
      if (whatWeBuildToggle && whatWeBuildSubmenu) {
        whatWeBuildToggle.addEventListener('click', function(e) {
          e.preventDefault();
          e.stopPropagation();
          whatWeBuildSubmenu.classList.toggle('hidden');
          if (whatWeBuildIcon) {
            whatWeBuildIcon.textContent = whatWeBuildSubmenu.classList.contains('hidden') ? '+' : '−';
          }
        });
      }
      
      // Resources toggle
      var resourcesToggle = document.querySelector('.resources-toggle');
      var resourcesSubmenu = document.querySelector('.resources-submenu');
      var resourcesIcon = document.querySelector('.resources-icon');
      
      if (resourcesToggle && resourcesSubmenu) {
        resourcesToggle.addEventListener('click', function(e) {
          e.preventDefault();
          e.stopPropagation();
          resourcesSubmenu.classList.toggle('hidden');
          if (resourcesIcon) {
            resourcesIcon.textContent = resourcesSubmenu.classList.contains('hidden') ? '+' : '−';
          }
        });
      }
    }
    
    // Close dropdowns on Escape key
    document.addEventListener('keydown', function(e) {
      if (e.key === 'Escape') {
        // Close all dropdowns (they close on mouse leave anyway, but this is for keyboard users)
        var dropdowns = document.querySelectorAll('nav .group > div[class*="absolute"]');
        dropdowns.forEach(function(dropdown) {
          dropdown.style.display = 'none';
        });
      }
    });
    
    // Run immediately if DOM is ready, otherwise wait
    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', function() {
        initMobileMenu();
        initMobileAccordions();
      });
    } else {
      initMobileMenu();
      initMobileAccordions();
    }
  })();
</script>
