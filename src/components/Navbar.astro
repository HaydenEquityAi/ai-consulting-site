---
// Universal Navigation Bar Component
// Used across ALL pages of the site
---

<nav class="fixed top-0 left-0 right-0 z-50 bg-white border-b border-gray-200 w-full">
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-3 sm:py-4 w-full">
    <div class="flex items-center justify-between gap-4 w-full min-w-0">
      <!-- LEFT: Logo -->
      <a href="/" class="text-2xl sm:text-3xl font-medium tracking-tight text-black flex-shrink-0">intelio</a>
      
      <!-- CENTER: Navigation Items -->
      <div class="hidden md:flex items-center gap-3 lg:gap-4 xl:gap-6 flex-1 justify-center max-w-4xl mx-auto min-w-0" style="overflow: visible;">
        <!-- Custom AI & Development Dropdown -->
        <div class="relative group" style="overflow: visible;">
          <button class="flex items-center gap-1 text-sm lg:text-base text-gray-700 hover:text-black transition-colors whitespace-nowrap">
            Custom AI & Development
            <svg class="w-4 h-4 transition-transform group-hover:rotate-180" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
            </svg>
          </button>
          <div class="absolute left-0 top-full w-[500px] bg-white rounded-2xl shadow-xl border border-gray-200 relative z-[100] overflow-hidden" style="transform: translateZ(0) scale(1); -webkit-transform: translateZ(0) scale(1); filter: none;">
            <div class="p-5 space-y-3">
              <a href="/custom-ai-development/full-stack-systems" class="group/item block hover:bg-gray-50 rounded-lg p-2 -m-2 transition-colors">
                <h3 class="text-sm font-semibold text-gray-900 mb-1 group-hover/item:text-blue-600 transition-colors">Full-Stack Custom Systems</h3>
                <p class="text-xs text-gray-600">Purpose-built software from database to user interface. Complete stack you own and control.</p>
              </a>
              <a href="/custom-ai-development/ai-intelligence-integration" class="group/item block hover:bg-gray-50 rounded-lg p-2 -m-2 transition-colors">
                <h3 class="text-sm font-semibold text-gray-900 mb-1 group-hover/item:text-blue-600 transition-colors">AI Intelligence Integration</h3>
                <p class="text-xs text-gray-600">Intelligent automation and decision support built into your workflows. Applied where it creates real leverage.</p>
              </a>
              <a href="/custom-ai-development/saas-product-development" class="group/item block hover:bg-gray-50 rounded-lg p-2 -m-2 transition-colors">
                <h3 class="text-sm font-semibold text-gray-900 mb-1 group-hover/item:text-blue-600 transition-colors">SaaS Product Development</h3>
                <p class="text-xs text-gray-600">Building scalable products and platforms. Custom systems that evolve into recurring revenue business assets.</p>
              </a>
              <a href="/custom-ai-development/custom-enterprise-builds" class="group/item block hover:bg-gray-50 rounded-lg p-2 -m-2 transition-colors">
                <h3 class="text-sm font-semibold text-gray-900 mb-1 group-hover/item:text-blue-600 transition-colors">Custom Enterprise Builds</h3>
                <p class="text-xs text-gray-600">Complex, multi-system implementations for organizations operating at scale or in specialized domains.</p>
              </a>
            </div>
          </div>
        </div>
        
        <!-- AI Integration & Automation Dropdown -->
        <div class="relative group" style="overflow: visible;">
          <button class="flex items-center gap-1 text-sm lg:text-base text-gray-700 hover:text-black transition-colors whitespace-nowrap">
            AI Integration & Automation
            <svg class="w-4 h-4 transition-transform group-hover:rotate-180" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
            </svg>
          </button>
          <div class="absolute left-0 top-full w-[500px] bg-white rounded-2xl shadow-xl border border-gray-200 relative z-[100] overflow-hidden" style="transform: translateZ(0) scale(1); -webkit-transform: translateZ(0) scale(1); filter: none;">
            <div class="p-5 space-y-3">
              <a href="/ai-integration-automation/system-integration" class="group/item block hover:bg-gray-50 rounded-lg p-2 -m-2 transition-colors">
                <h3 class="text-sm font-semibold text-gray-900 mb-1 group-hover/item:text-blue-600 transition-colors">System Integration</h3>
                <p class="text-xs text-gray-600">Connect CRMs, accounting, operations, and data systems. One connected stack instead of disconnected tools.</p>
              </a>
              <a href="/ai-integration-automation/workflow-automation" class="group/item block hover:bg-gray-50 rounded-lg p-2 -m-2 transition-colors">
                <h3 class="text-sm font-semibold text-gray-900 mb-1 group-hover/item:text-blue-600 transition-colors">Workflow Automation</h3>
                <p class="text-xs text-gray-600">Automate repetitive processes, approvals, handoffs, and data entry. Remove manual work from your operations.</p>
              </a>
              <a href="/ai-integration-automation/ai-enhanced-operations" class="group/item block hover:bg-gray-50 rounded-lg p-2 -m-2 transition-colors">
                <h3 class="text-sm font-semibold text-gray-900 mb-1 group-hover/item:text-blue-600 transition-colors">AI-Enhanced Operations</h3>
                <p class="text-xs text-gray-600">Embed AI into existing workflows—document processing, intelligent routing, decision support, and predictive automation.</p>
              </a>
              <a href="/ai-integration-automation/data-connectivity" class="group/item block hover:bg-gray-50 rounded-lg p-2 -m-2 transition-colors">
                <h3 class="text-sm font-semibold text-gray-900 mb-1 group-hover/item:text-blue-600 transition-colors">Data Connectivity & Visibility</h3>
                <p class="text-xs text-gray-600">Unified dashboards, real-time reporting, and data pipelines that give leadership the visibility they need.</p>
              </a>
            </div>
          </div>
        </div>
        
        <!-- How We Work (single link) -->
        <a href="/how-we-work" class="text-sm lg:text-base text-gray-700 hover:text-black transition-colors whitespace-nowrap">How We Work</a>
        
        <!-- Case Studies (single link) -->
        <a href="/case-studies" class="text-sm lg:text-base text-gray-700 hover:text-black transition-colors whitespace-nowrap">Case Studies</a>
        
        <!-- Resources Dropdown -->
        <div class="relative group" style="overflow: visible;">
          <button class="flex items-center gap-1 text-sm lg:text-base text-gray-700 hover:text-black transition-colors whitespace-nowrap">
            Resources
            <svg class="w-4 h-4 transition-transform group-hover:rotate-180" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
            </svg>
          </button>
          <div class="absolute left-0 top-full w-64 bg-white rounded-2xl shadow-xl border border-gray-200 relative z-[100] overflow-hidden" style="transform: translateZ(0) scale(1); -webkit-transform: translateZ(0) scale(1); filter: none;">
            <div class="p-4 space-y-3">
              <a href="/resources/insights" class="block hover:bg-gray-50 rounded-lg p-3 -m-3 transition-colors">
                <h3 class="text-base font-semibold text-gray-900 mb-1">Insights</h3>
                <p class="text-sm text-gray-600">Articles and perspectives on business systems.</p>
              </a>
              <a href="/resources/tools" class="block hover:bg-gray-50 rounded-lg p-3 -m-3 transition-colors">
                <h3 class="text-base font-semibold text-gray-900 mb-1">Tools</h3>
                <p class="text-sm text-gray-600">A curated list of AI tools we use and recommend</p>
              </a>
              <a href="/resources/glossary" class="block hover:bg-gray-50 rounded-lg p-3 -m-3 transition-colors">
                <h3 class="text-base font-semibold text-gray-900 mb-1">Glossary</h3>
                <p class="text-sm text-gray-600">Definitions and terminology.</p>
              </a>
            </div>
          </div>
        </div>
      </div>
      
      <!-- RIGHT: CTA Button -->
      <div class="hidden md:flex items-center flex-shrink-0">
        <a href="/contact" class="px-5 py-2.5 bg-black text-white text-base font-medium rounded-full hover:bg-gray-800 transition-colors whitespace-nowrap">Work With Us</a>
      </div>
      
      <!-- Mobile Menu Button -->
      <button type="button" id="mobile-menu-button" class="md:hidden p-3 min-h-[48px] min-w-[48px] flex items-center justify-center" aria-label="Toggle menu" aria-expanded="false">
        <svg id="mobile-menu-icon" class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path id="menu-icon-open" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
          <path id="menu-icon-close" class="hidden" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
        </svg>
      </button>
    </div>
    
    <!-- Mobile Menu -->
    <div id="mobile-menu" class="hidden md:hidden mt-4 pb-4 border-t border-gray-100 bg-white z-40 max-h-[calc(100vh-80px)] overflow-y-auto">
      <nav class="flex flex-col gap-2 sm:gap-4 pt-4 px-4 sm:px-6">
        <!-- Custom AI & Development (Mobile Accordion) -->
        <div class="py-2">
          <button type="button" class="custom-ai-dev-toggle text-sm font-medium text-gray-700 hover:text-black w-full text-left flex items-center justify-between min-h-[44px]">
            Custom AI & Development
            <span class="custom-ai-dev-icon text-xs">+</span>
          </button>
          <div class="custom-ai-dev-submenu hidden pl-4 space-y-2 border-l border-gray-200 mt-2">
            <a href="/custom-ai-development/full-stack-systems" class="block text-sm text-gray-600 hover:text-black transition-colors py-2 min-h-[44px] flex items-center">Full-Stack Custom Systems</a>
            <a href="/custom-ai-development/ai-intelligence-integration" class="block text-sm text-gray-600 hover:text-black transition-colors py-2 min-h-[44px] flex items-center">AI Intelligence Integration</a>
            <a href="/custom-ai-development/saas-product-development" class="block text-sm text-gray-600 hover:text-black transition-colors py-2 min-h-[44px] flex items-center">SaaS Product Development</a>
            <a href="/custom-ai-development/custom-enterprise-builds" class="block text-sm text-gray-600 hover:text-black transition-colors py-2 min-h-[44px] flex items-center">Custom Enterprise Builds</a>
          </div>
        </div>
        
        <!-- AI Integration & Automation (Mobile Accordion) -->
        <div class="py-2">
          <button type="button" class="what-we-build-toggle text-sm font-medium text-gray-700 hover:text-black w-full text-left flex items-center justify-between min-h-[44px]">
            AI Integration & Automation
            <span class="what-we-build-icon text-xs">+</span>
          </button>
          <div class="what-we-build-submenu hidden pl-4 space-y-2 border-l border-gray-200 mt-2">
            <a href="/ai-integration-automation/system-integration" class="block text-sm text-gray-600 hover:text-black transition-colors py-2 min-h-[44px] flex items-center">System Integration</a>
            <a href="/ai-integration-automation/workflow-automation" class="block text-sm text-gray-600 hover:text-black transition-colors py-2 min-h-[44px] flex items-center">Workflow Automation</a>
            <a href="/ai-integration-automation/ai-enhanced-operations" class="block text-sm text-gray-600 hover:text-black transition-colors py-2 min-h-[44px] flex items-center">AI-Enhanced Operations</a>
            <a href="/ai-integration-automation/data-connectivity" class="block text-sm text-gray-600 hover:text-black transition-colors py-2 min-h-[44px] flex items-center">Data Connectivity & Visibility</a>
          </div>
        </div>
        
        <!-- How We Work (Mobile) -->
        <a href="/how-we-work" class="block py-2 text-sm text-gray-700 hover:text-black transition-colors min-h-[44px] flex items-center">How We Work</a>
        
        <!-- Case Studies (Mobile) -->
        <a href="/case-studies" class="block py-2 text-sm text-gray-700 hover:text-black transition-colors min-h-[44px] flex items-center">Case Studies</a>
        
        <!-- Resources (Mobile Accordion) -->
        <div class="py-2">
          <button type="button" class="resources-toggle text-sm font-medium text-gray-700 hover:text-black w-full text-left flex items-center justify-between min-h-[44px]">
            Resources
            <span class="resources-icon text-xs">+</span>
          </button>
          <div class="resources-submenu hidden pl-4 space-y-2 border-l border-gray-200 mt-2">
            <a href="/resources/insights" class="block text-sm text-gray-600 hover:text-black transition-colors py-2 min-h-[44px] flex items-center">Insights</a>
            <a href="/resources/tools" class="block text-sm text-gray-600 hover:text-black transition-colors py-2 min-h-[44px] flex items-center">Tools</a>
            <a href="/resources/glossary" class="block text-sm text-gray-600 hover:text-black transition-colors py-2 min-h-[44px] flex items-center">Glossary</a>
          </div>
        </div>
        
        <!-- Work With Us (Mobile) -->
        <a href="/contact" class="block py-3 mt-4 bg-black text-white text-sm text-center rounded-full hover:bg-gray-800 transition-colors min-h-[44px] flex items-center justify-center">Work With Us</a>
      </nav>
    </div>
  </div>
</nav>

<style>
  /* Dropdown visibility using CSS - matches existing pattern */
  nav {
    overflow: visible !important;
  }
  
  nav > div {
    overflow: visible !important;
  }
  
  nav .group {
    overflow: visible !important;
  }
  
  nav .group > div[class*="absolute"] {
    z-index: 9999 !important;
    position: absolute;
    display: none !important;
    transform: translateZ(0) scale(1);
    -webkit-transform: translateZ(0) scale(1);
    will-change: transform;
    backface-visibility: hidden;
    -webkit-backface-visibility: hidden;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
    text-rendering: optimizeLegibility;
    image-rendering: crisp-edges;
    filter: none !important;
    opacity: 1 !important;
    transition: none !important;
    visibility: hidden !important;
    pointer-events: none !important;
    margin-top: 0.5rem !important;
    top: 100% !important;
    overflow: visible !important;
  }

  /* Invisible bridge for hover continuity */
  nav .group > div[class*="absolute"]::before {
    content: '';
    position: absolute;
    top: -1rem;
    left: -50px;
    right: -50px;
    width: calc(100% + 100px);
    height: 1rem;
    background: transparent;
    z-index: 10001;
    pointer-events: auto;
  }

  /* Show dropdown on hover */
  nav .group:hover > div[class*="absolute"] {
    display: block !important;
    visibility: visible !important;
    pointer-events: auto !important;
    opacity: 1 !important;
    transition: none !important;
    filter: none !important;
  }

  /* Keep dropdown open when hovering over it */
  nav .group > div[class*="absolute"]:hover {
    display: block !important;
    visibility: visible !important;
    pointer-events: auto !important;
    opacity: 1 !important;
  }
  
  /* Mobile menu improvements */
  @media (max-width: 767px) {
    #mobile-menu {
      position: relative;
      z-index: 40;
      max-height: calc(100vh - 80px);
      overflow-y: auto;
      -webkit-overflow-scrolling: touch;
    }
    
    #mobile-menu-button {
      touch-action: manipulation;
      -webkit-tap-highlight-color: transparent;
    }
    
    /* Ensure mobile menu items are easily tappable */
    #mobile-menu a,
    #mobile-menu button {
      touch-action: manipulation;
      -webkit-tap-highlight-color: rgba(0, 0, 0, 0.1);
    }
    
    /* Prevent body scroll when menu is open */
    body.menu-open {
      overflow: hidden;
    }
  }
</style>

<script>
  (function() {
    function initMobileMenu() {
      var btn = document.getElementById('mobile-menu-button');
      var menu = document.getElementById('mobile-menu');
      var iconOpen = document.getElementById('menu-icon-open');
      var iconClose = document.getElementById('menu-icon-close');
      
      if (!btn || !menu) {
        return;
      }
      
      btn.addEventListener('click', function(e) {
        e.preventDefault();
        e.stopPropagation();
        
        var isHidden = menu.classList.contains('hidden');
        menu.classList.toggle('hidden');
        
        // Toggle body scroll lock on mobile
        if (window.innerWidth < 768) {
          if (isHidden) {
            document.body.classList.add('menu-open');
          } else {
            document.body.classList.remove('menu-open');
          }
        }
        
        // Update icon based on menu state
        if (iconOpen && iconClose) {
          if (isHidden) {
            // Opening menu - show close icon, hide open icon
            iconOpen.classList.add('hidden');
            iconClose.classList.remove('hidden');
            btn.setAttribute('aria-expanded', 'true');
          } else {
            // Closing menu - show open icon, hide close icon
            iconOpen.classList.remove('hidden');
            iconClose.classList.add('hidden');
            btn.setAttribute('aria-expanded', 'false');
          }
        }
      });
      
      // Close when clicking outside
      document.addEventListener('click', function(e) {
        if (!menu.contains(e.target) && !btn.contains(e.target) && !menu.classList.contains('hidden')) {
          menu.classList.add('hidden');
          document.body.classList.remove('menu-open');
          if (iconOpen && iconClose) {
            iconOpen.classList.remove('hidden');
            iconClose.classList.add('hidden');
            btn.setAttribute('aria-expanded', 'false');
          }
        }
      });
      
      // Prevent menu from closing when clicking inside it
      menu.addEventListener('click', function(e) {
        e.stopPropagation();
      });
      
      // Close menu when a link is clicked (but not for accordion toggles)
      var menuLinks = menu.querySelectorAll('a:not(.what-we-build-toggle):not(.resources-toggle):not(.custom-ai-dev-toggle)');
      menuLinks.forEach(function(link) {
        link.addEventListener('click', function() {
          menu.classList.add('hidden');
          document.body.classList.remove('menu-open');
          if (iconOpen && iconClose) {
            iconOpen.classList.remove('hidden');
            iconClose.classList.add('hidden');
            btn.setAttribute('aria-expanded', 'false');
          }
        });
      });
    }
    
    // Mobile accordion toggles
    function initMobileAccordions() {
      // Business Systems toggle
      var whatWeBuildToggle = document.querySelector('.what-we-build-toggle');
      var whatWeBuildSubmenu = document.querySelector('.what-we-build-submenu');
      var whatWeBuildIcon = document.querySelector('.what-we-build-icon');
      
      if (whatWeBuildToggle && whatWeBuildSubmenu) {
        whatWeBuildToggle.addEventListener('click', function(e) {
          e.preventDefault();
          e.stopPropagation();
          whatWeBuildSubmenu.classList.toggle('hidden');
          if (whatWeBuildIcon) {
            whatWeBuildIcon.textContent = whatWeBuildSubmenu.classList.contains('hidden') ? '+' : '−';
          }
        });
      }
      
      // Resources toggle
      var resourcesToggle = document.querySelector('.resources-toggle');
      var resourcesSubmenu = document.querySelector('.resources-submenu');
      var resourcesIcon = document.querySelector('.resources-icon');
      
      if (resourcesToggle && resourcesSubmenu) {
        resourcesToggle.addEventListener('click', function(e) {
          e.preventDefault();
          e.stopPropagation();
          resourcesSubmenu.classList.toggle('hidden');
          if (resourcesIcon) {
            resourcesIcon.textContent = resourcesSubmenu.classList.contains('hidden') ? '+' : '−';
          }
        });
      }
      
      // Custom AI & Development toggle
      var customAiDevToggle = document.querySelector('.custom-ai-dev-toggle');
      var customAiDevSubmenu = document.querySelector('.custom-ai-dev-submenu');
      var customAiDevIcon = document.querySelector('.custom-ai-dev-icon');
      
      if (customAiDevToggle && customAiDevSubmenu) {
        customAiDevToggle.addEventListener('click', function(e) {
          e.preventDefault();
          e.stopPropagation();
          customAiDevSubmenu.classList.toggle('hidden');
          if (customAiDevIcon) {
            customAiDevIcon.textContent = customAiDevSubmenu.classList.contains('hidden') ? '+' : '−';
          }
        });
      }
    }
    
    // Close dropdowns on Escape key
    document.addEventListener('keydown', function(e) {
      if (e.key === 'Escape') {
        // Close all dropdowns (they close on mouse leave anyway, but this is for keyboard users)
        var dropdowns = document.querySelectorAll('nav .group > div[class*="absolute"]');
        dropdowns.forEach(function(dropdown) {
          dropdown.style.display = 'none';
        });
      }
    });
    
    // Run immediately if DOM is ready, otherwise wait
    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', function() {
        initMobileMenu();
        initMobileAccordions();
      });
    } else {
      initMobileMenu();
      initMobileAccordions();
    }
  })();
</script>
